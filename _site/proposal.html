<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IS415 Geospatial Analytics Project Proposal - Group 10 – IS415 G10 Group Prject: Vietnam Economic Development from 2019-2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IS415 G10 Group Prject: Vietnam Economic Development from 2019-2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./proposal.html" aria-current="page"> 
<span class="menu-text">Project Proposal</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vietnam-economic-development-from-2012-2023" id="toc-vietnam-economic-development-from-2012-2023" class="nav-link active" data-scroll-target="#vietnam-economic-development-from-2012-2023">Vietnam Economic development from 2012-2023</a></li>
  <li><a href="#group-members" id="toc-group-members" class="nav-link" data-scroll-target="#group-members">Group Members:</a></li>
  <li><a href="#project-summary" id="toc-project-summary" class="nav-link" data-scroll-target="#project-summary"><strong>Project Summary:</strong></a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation"><strong>Motivation:</strong></a></li>
  <li><a href="#problems-or-issues" id="toc-problems-or-issues" class="nav-link" data-scroll-target="#problems-or-issues"><strong>Problems or Issues:</strong></a></li>
  <li><a href="#relevant-related-work" id="toc-relevant-related-work" class="nav-link" data-scroll-target="#relevant-related-work"><strong>Relevant Related Work:</strong></a></li>
  <li><a href="#approach-and-methodology" id="toc-approach-and-methodology" class="nav-link" data-scroll-target="#approach-and-methodology"><strong>Approach and Methodology:</strong></a></li>
  <li><a href="#expected-outcomes" id="toc-expected-outcomes" class="nav-link" data-scroll-target="#expected-outcomes"><strong>Expected Outcomes:</strong></a></li>
  <li><a href="#challenges-and-limitations" id="toc-challenges-and-limitations" class="nav-link" data-scroll-target="#challenges-and-limitations"><strong>Challenges and Limitations:</strong></a></li>
  </ul></li>
  <li><a href="#links" id="toc-links" class="nav-link" data-scroll-target="#links">Links</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>References:</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">IS415 Geospatial Analytics Project Proposal - Group 10</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="vietnam-economic-development-from-2012-2023" class="level3">
<h3 class="anchored" data-anchor-id="vietnam-economic-development-from-2012-2023">Vietnam Economic development from 2012-2023</h3>
</section>
<section id="group-members" class="level3">
<h3 class="anchored" data-anchor-id="group-members">Group Members:</h3>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Xu Haiyang</td>
<td>01431654</td>
</tr>
<tr class="even">
<td>Javier Lian</td>
<td>01414631</td>
</tr>
<tr class="odd">
<td>Han Ming Yan</td>
<td>01414457</td>
</tr>
</tbody>
</table>
</section>
<section id="project-summary" class="level2">
<h2 class="anchored" data-anchor-id="project-summary"><strong>Project Summary:</strong></h2>
<p>Our study focuses on analyzing the economic development of Vietnam at the provincial level, specifically utilizing three main datasets: “Number of farms by kinds of economic activity and by province,” “Number of newly established enterprises by province,” and “Index of Industrial production by province.” By incorporating geospatial data, we aim to explore spatial patterns in economic activities and assess regional disparities in Vietnam’s growth from 2012 to 2023.</p>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation"><strong>Motivation:</strong></h3>
<p>Vietnam’s rapid economic growth in recent years has positioned it as a key player in the ASEAN region. As a member of ASEAN, Vietnam shares strong economic ties with countries like Singapore, which is one of its largest trading partners. Understanding Vietnam’s economic development, particularly in terms of agriculture, industry, and enterprise growth at the provincial level, is crucial for assessing the country’s future trajectory within the regional economic landscape.</p>
<p>This analysis can offer valuable insights into how Vietnam’s internal economic dynamics may influence and interact with broader ASEAN trade and investment patterns. By identifying regional disparities and growth trends, we can contribute to better policymaking and investment decisions not only for Vietnam but also for ASEAN partners seeking opportunities in Vietnam’s developing markets. This type of analysis becomes especially important as Vietnam strives for greater integration into the global economy while balancing its role within ASEAN.</p>
</section>
<section id="problems-or-issues" class="level3">
<h3 class="anchored" data-anchor-id="problems-or-issues"><strong>Problems or Issues:</strong></h3>
<ol type="1">
<li><p><strong>Regional Economic Disparities:</strong> Despite Vietnam’s overall economic growth, there are notable disparities between provinces, especially between more industrialized urban areas and agricultural rural regions. Understanding the spatial distribution of growth and inequality across the country will help identify regions that may be lagging behind and in need of policy attention.</p></li>
<li><p><strong>Balancing Agricultural and Industrial Development:</strong> Vietnam’s economy has historically relied heavily on agriculture, but recent industrialization efforts have shifted the focus toward manufacturing and services. This shift may affect rural provinces that still depend on agriculture. Our analysis will explore how different provinces are transitioning between these sectors and how this shift might impact the future of both agriculture and industry.</p></li>
<li><p><strong>Inter-Regional Economic Dependencies within ASEAN:</strong> Vietnam’s economic development is closely tied to its relationships with other ASEAN countries like Singapore. As trade and investment flows increase within ASEAN, understanding how Vietnam’s internal economic structure supports or hinders these relationships is crucial. Regional economic dependencies and potential bottlenecks must be addressed for sustained growth in both Vietnam and ASEAN.</p></li>
</ol>
</section>
<section id="relevant-related-work" class="level3">
<h3 class="anchored" data-anchor-id="relevant-related-work"><strong>Relevant Related Work:</strong></h3>
<p>Previous research has documented Vietnam’s transformation into an industrialized and export-driven economy, driven by integration into global supply chains and trade agreements. Studies have highlighted how the country’s shift toward manufacturing has fostered urbanization and economic growth, particularly in the north and south, where major cities like Hanoi and Ho Chi Minh City serve as economic hubs.</p>
<p>In the context of agriculture, the Mekong Delta continues to be a vital contributor to Vietnam’s economic stability, particularly for rice and fisheries exports. However, concerns over environmental sustainability and the impact of economic diversification on agricultural regions have been raised, suggesting a need for balanced development across sectors.</p>
<p>Geospatial analysis of economic activities across Vietnam has revealed a growing divide between urban and rural regions, with provinces close to economic hubs experiencing faster development than peripheral areas. Additionally, regional studies within ASEAN have emphasized the importance of cross-border economic interactions, particularly between Vietnam and Singapore, in shaping both countries’ long-term growth trajectories.</p>
</section>
<section id="approach-and-methodology" class="level3">
<h3 class="anchored" data-anchor-id="approach-and-methodology"><strong>Approach and Methodology:</strong></h3>
<ol type="1">
<li><p><strong>Data Collection:</strong> We will use the following datasets:</p>
<ul>
<li><p>“Number of farms by kinds of economic activity and by province” dataset (2012-2023), sourced from the <strong>General Statistics Office</strong> (<a href="https://www.gso.gov.vn/en/homepage/">GSO</a>).</p></li>
<li><p>“Number of newly established enterprises by province” dataset, sourced from GSO.</p></li>
<li><p>“Index of Industrial production by province” dataset, sourced from GSO.</p></li>
<li><p>Vietnam’s provincial geospatial boundaries dataset, sourced from <strong>Open Development Mekong</strong> (<a href="https://data.opendevelopmentmekong.net/dataset/a-phn-tnh">dataset link</a>).</p></li>
</ul></li>
<li><p><strong>Analytical Themes:</strong></p>
<ul>
<li><p><strong>Analytical Regionalisation and Geographical Segmentation:</strong> We will apply clustering techniques to segment Vietnam’s provinces into distinct economic regions based on the number of farms, industrial output, and newly established enterprises. This will allow us to classify regions with similar economic characteristics and highlight provincial-level economic disparities.</p></li>
<li><p><strong>Geographically Weighted Regression (GWR):</strong> GWR will be used to assess how relationships between different economic indicators (e.g., farm numbers, industrial production) and overall economic performance vary across provinces. This method will account for spatial heterogeneity, enabling us to see how the impact of variables like agriculture or industry differs regionally.</p></li>
</ul></li>
<li><p><strong>Data Processing:</strong></p>
<ul>
<li><p>We will harmonize all datasets by ensuring they are aligned with provincial boundaries and time periods.</p></li>
<li><p>Standardizing and normalizing economic indicators to account for differences in provincial population sizes or geographic areas.</p></li>
<li><p>Applying clustering algorithms (such as K-means) for regionalisation and performing GWR to model regional variation in economic outcomes.</p></li>
</ul></li>
<li><p><strong>Geospatial Analysis:</strong></p>
<ul>
<li><p>Mapping and visualizing regions based on the segmentation to identify clusters of provinces with similar economic profiles.</p></li>
<li><p>Using GWR to visualize spatially varying relationships between economic indicators and their impacts across Vietnam’s provinces.</p></li>
</ul></li>
</ol>
</section>
<section id="expected-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="expected-outcomes"><strong>Expected Outcomes:</strong></h3>
<ol type="1">
<li><p><strong>Regional Economic Segmentation:</strong> We will provide a clear classification of Vietnam’s provinces into distinct economic regions, based on their performance in agriculture, industrial output, and enterprise development. This will highlight regions that share similar economic profiles and identify which provinces are leading or lagging behind.</p></li>
<li><p><strong>Insights into Spatial Economic Variation:</strong> Through the GWR analysis, we will offer detailed insights into how the relationships between economic activities (e.g., number of farms, industrial production) and overall economic performance differ across provinces. This will shed light on how agricultural or industrial strengths influence growth differently in various parts of the country.</p></li>
<li><p><strong>Actionable Recommendations:</strong> Based on the segmentation and regression results, we can offer recommendations for policymakers and investors on regions that require further development or where specific economic sectors should be strengthened to promote balanced growth.</p></li>
</ol>
</section>
<section id="challenges-and-limitations" class="level3">
<h3 class="anchored" data-anchor-id="challenges-and-limitations"><strong>Challenges and Limitations:</strong></h3>
<ol type="1">
<li><p><strong>Data Consistency and Quality:</strong> The datasets may not cover all provinces equally across all years, which could result in incomplete or biased analyses. Harmonizing data from multiple years and ensuring alignment across provinces could be challenging.</p></li>
<li><p><strong>Spatial Scale Limitations:</strong> Since the analysis is at the provincial level, the insights derived from regional segmentation or GWR may not capture finer-scale intra-provincial disparities, particularly in large provinces with significant internal variation.</p></li>
<li><p><strong>Model Sensitivity:</strong> Geographically Weighted Regression models can be sensitive to bandwidth selection and may produce unstable results in regions with sparse data. This could impact the reliability of the results in provinces with lower economic activity or incomplete data records.</p></li>
</ol>
</section>
</section>
<section id="links" class="level2">
<h2 class="anchored" data-anchor-id="links">Links</h2>
<p>GitHub Link: <a href="https://github.com/EasonXu-HY99/IS415_G10">EasonXu-HY99/IS415_G10: IS415 G10 group project (github.com)</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references"><strong>References:</strong></h2>
<ul>
<li><p>General Statistics Office of Vietnam. (n.d.). Statistical data on farms, enterprises, and industrial production. General Statistics Office of Vietnam. Retrieved from <a href="https://www.gso.gov.vn/en/homepage/" class="uri">https://www.gso.gov.vn/en/homepage/</a></p></li>
<li><p>Open Development Mekong. (n.d.). Vietnam provincial boundaries dataset. Open Development Mekong. Retrieved from <a href="https://data.opendevelopmentmekong.net/dataset/a-phn-tnh" class="uri">https://data.opendevelopmentmekong.net/dataset/a-phn-tnh</a></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>