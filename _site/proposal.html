<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>IS415 G10 Group Prject: Vietnam Economic Development from 2019-2023 - IS415 Geospatial Analytics Project Proposal - Group 10</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">IS415 G10 Group Prject: Vietnam Economic Development from 2019-2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./proposal.html" aria-current="page"> 
<span class="menu-text">Project Proposal</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vietnam-economic-development-from-2019-2023" id="toc-vietnam-economic-development-from-2019-2023" class="nav-link active" data-scroll-target="#vietnam-economic-development-from-2019-2023">Vietnam Economic development from 2019-2023</a></li>
  <li><a href="#group-members" id="toc-group-members" class="nav-link" data-scroll-target="#group-members">Group Members:</a></li>
  <li><a href="#project-summary" id="toc-project-summary" class="nav-link" data-scroll-target="#project-summary">Project Summary:</a>
  <ul class="collapse">
  <li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation">Motivation:</a></li>
  </ul></li>
  <li><a href="#problems-or-issues" id="toc-problems-or-issues" class="nav-link" data-scroll-target="#problems-or-issues"><strong>Problems or Issues:</strong></a></li>
  <li><a href="#relevant-related-work" id="toc-relevant-related-work" class="nav-link" data-scroll-target="#relevant-related-work"><strong>Relevant Related Work:</strong></a></li>
  <li><a href="#approach-and-methodology" id="toc-approach-and-methodology" class="nav-link" data-scroll-target="#approach-and-methodology"><strong>Approach and Methodology:</strong></a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection"><strong>1. Data Collection:</strong></a></li>
  <li><a href="#analytical-themes" id="toc-analytical-themes" class="nav-link" data-scroll-target="#analytical-themes"><strong>2. Analytical Themes:</strong></a></li>
  <li><a href="#data-processing" id="toc-data-processing" class="nav-link" data-scroll-target="#data-processing"><strong>3. Data Processing:</strong></a></li>
  <li><a href="#early-prototypesstoryboards" id="toc-early-prototypesstoryboards" class="nav-link" data-scroll-target="#early-prototypesstoryboards"><strong>4. Early Prototypes/Storyboards:</strong></a></li>
  </ul></li>
  <li><a href="#expected-outcomes" id="toc-expected-outcomes" class="nav-link" data-scroll-target="#expected-outcomes"><strong>Expected Outcomes:</strong></a></li>
  <li><a href="#challenges-and-limitations" id="toc-challenges-and-limitations" class="nav-link" data-scroll-target="#challenges-and-limitations"><strong>Challenges and Limitations:</strong></a></li>
  <li><a href="#links" id="toc-links" class="nav-link" data-scroll-target="#links">Links</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><strong>References:</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">IS415 Geospatial Analytics Project Proposal - Group 10</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="vietnam-economic-development-from-2019-2023" class="level3">
<h3 class="anchored" data-anchor-id="vietnam-economic-development-from-2019-2023">Vietnam Economic development from 2019-2023</h3>
</section>
<section id="group-members" class="level3">
<h3 class="anchored" data-anchor-id="group-members">Group Members:</h3>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Xu Haiyang</td>
<td>01431654</td>
</tr>
<tr class="even">
<td>Javier Lian</td>
<td>01414631</td>
</tr>
<tr class="odd">
<td>Han Ming Yan</td>
<td>01414457</td>
</tr>
</tbody>
</table>
</section>
<section id="project-summary" class="level2">
<h2 class="anchored" data-anchor-id="project-summary">Project Summary:</h2>
<section id="motivation" class="level3">
<h3 class="anchored" data-anchor-id="motivation">Motivation:</h3>
<p>Our initial motivation stemmed from news about Cambodia’s groundbreaking of the China-funded canal project in August 2024, aimed at connecting Phnom Penh to the Gulf of Thailand. While the project has sparked interest, the limited availability of data and the short period since its inception made it difficult to analyse the economic impacts on Cambodia.</p>
<p>Further investigation into the news revealed concerns about the project’s environmental impact on neighbouring Vietnam, particularly regarding the Mekong Delta, a critical economic region for Vietnam. This prompted our group to shift focus to Vietnam’s economic development over the last five years (2019-2023), aiming to explore how this economic growth has evolved and how future infrastructure projects like the canal might influence the country’s economy.</p>
<p>Vietnam has made significant strides in economic development, transitioning from one of the poorest countries to a middle-income nation. We focus on Vietnam’s development from 2019 to 2023, a crucial period marked by resilience in the face of global challenges such as COVID-19. Understanding how Vietnam navigated these challenges and continued its growth can offer insights for future economic planning, especially as the country aims to achieve high-income status by 2045.</p>
<p>We plan to investigate the overall economic development trends in Vietnam, using the most recent five years as a baseline, and provide insights into how projects like Cambodia’s Funan Canal project may further impact Vietnam.</p>
</section>
</section>
<section id="problems-or-issues" class="level2">
<h2 class="anchored" data-anchor-id="problems-or-issues"><strong>Problems or Issues:</strong></h2>
<ol type="1">
<li><p><strong>Economic Vulnerability to External Projects</strong>: Vietnam’s economy, particularly its trade and agriculture sectors, may face challenges from external infrastructure projects like Cambodia’s canal. The canal could divert trade routes, impacting Vietnam’s ports and potentially reducing their economic importance.</p></li>
<li><p><strong>Environmental and Agricultural Risks</strong>: The Mekong Delta, a key agricultural region, may face environmental changes due to the canal’s impact on water resources, which could, in turn, affect Vietnam’s agricultural output and overall economic stability.</p></li>
<li><p><strong>Economic Disparities Across Regions</strong>: Vietnam has experienced rapid economic growth, but this development has not been evenly distributed. Our analysis aims to explore how different regions have fared during the 2019-2023 period and identify patterns of growth and disparity.</p></li>
</ol>
</section>
<section id="relevant-related-work" class="level2">
<h2 class="anchored" data-anchor-id="relevant-related-work"><strong>Relevant Related Work:</strong></h2>
<p>Previous studies on Vietnam’s economic development have emphasised its rapid industrialization, growing export economy, and integration into global markets through free trade agreements. Research has also highlighted Vietnam’s dependence on the Mekong Delta for agriculture, which plays a significant role in the country’s economy and could be impacted by water-related projects like Cambodia’s canal.</p>
<p>In terms of geospatial analysis, prior work has explored the spatial distribution of economic activities across Vietnam, highlighting disparities between urban and rural regions. Additionally, studies on transboundary water resource management between Vietnam and Cambodia underscore the geopolitical and environmental concerns associated with infrastructure projects like the canal.</p>
</section>
<section id="approach-and-methodology" class="level2">
<h2 class="anchored" data-anchor-id="approach-and-methodology"><strong>Approach and Methodology:</strong></h2>
<section id="data-collection" class="level3">
<h3 class="anchored" data-anchor-id="data-collection"><strong>1. Data Collection:</strong></h3>
<p>We will gather comprehensive datasets to track Vietnam’s economic performance from 2019 to 2023. These datasets will include:</p>
<ul>
<li><p><strong>Economic Data</strong>: GDP growth, trade, foreign direct investment, and labour market indicators sourced from the <strong>World Bank</strong>, <strong>Asian Development Bank (ADB)</strong>, and <strong>Vietnam’s General Statistics Office (GSO)</strong>.</p></li>
<li><p><strong>Environmental Data</strong>: Mekong River water flow data and environmental indicators sourced from the <strong>Mekong River Commission (MRC)</strong> and <strong>Global Forest Watch</strong>.</p></li>
</ul>
</section>
<section id="analytical-themes" class="level3">
<h3 class="anchored" data-anchor-id="analytical-themes"><strong>2. Analytical Themes:</strong></h3>
<ul>
<li><p><strong>Spatial Point Patterns Analysis</strong>: This will help us explore how economic activities, such as GDP growth, are distributed across Vietnam’s regions. We will investigate whether there are clusters or specific regions showing significant economic development and whether these regions are positioned to be impacted by external projects like the Cambodian canal.</p></li>
<li><p><strong>Exploratory Spatial Data Analysis (ESDA)</strong>: ESDA will allow us to visualise and assess spatial relationships between economic variables, such as trade activity and labour market conditions, across Vietnam’s provinces. This approach will help us identify geographic disparities in economic development.</p></li>
</ul>
</section>
<section id="data-processing" class="level3">
<h3 class="anchored" data-anchor-id="data-processing"><strong>3. Data Processing:</strong></h3>
<p>To ensure consistency across datasets, we will harmonise them using spatial interpolation and transformation techniques. This will involve aligning various data sources to common geographical units, such as Vietnam’s administrative divisions (provinces and districts).</p>
</section>
<section id="early-prototypesstoryboards" class="level3">
<h3 class="anchored" data-anchor-id="early-prototypesstoryboards"><strong>4. Early Prototypes/Storyboards:</strong></h3>
<ul>
<li><p><strong>Interactive Map</strong>: We have begun developing an interactive map that displays economic indicators, such as GDP growth, across Vietnam’s provinces for 2019-2023.</p></li>
<li><p><strong>Spatial Analysis</strong>: We have also sketched out visualisations showing the distribution of economic activity and identifying potential regions that might be most affected by the Cambodian canal project in the future.</p></li>
</ul>
</section>
</section>
<section id="expected-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="expected-outcomes"><strong>Expected Outcomes:</strong></h2>
<ul>
<li><p><strong>Comprehensive Economic Baseline</strong>: We will provide an in-depth analysis of Vietnam’s economic development over the past five years, identifying key regions of growth and disparity.</p></li>
<li><p><strong>Impact Prediction</strong>: Using spatial analysis, we aim to predict how projects like Cambodia’s canal could influence Vietnam’s economy, particularly in the Mekong Delta region.</p></li>
<li><p><strong>Geospatial Visualisations</strong>: We will develop interactive maps and visualisations that clearly illustrate economic trends across Vietnam, highlighting regions that may be vulnerable to external changes.</p></li>
</ul>
</section>
<section id="challenges-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="challenges-and-limitations"><strong>Challenges and Limitations:</strong></h2>
<ul>
<li><p><strong>Data Gaps</strong>: While we expect to collect comprehensive data, there may be gaps or missing neighbour provinces in high-resolution environmental and conflict data for specific regions in Vietnam.</p></li>
<li><p><strong>Cross-border Impacts</strong>: Analysing the indirect impact of external projects like Cambodia’s canal on Vietnam’s economy may be difficult due to the limited availability of cross-border economic interaction data.</p></li>
</ul>
</section>
<section id="links" class="level2">
<h2 class="anchored" data-anchor-id="links">Links</h2>
<p>GitHub Link: <a href="https://github.com/EasonXu-HY99/IS415_G10">EasonXu-HY99/IS415_G10: IS415 G10 group project (github.com)</a></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references"><strong>References:</strong></h2>
<ol type="1">
<li><p>AP News. (2024, August 9). Cambodia breaks ground on a China-funded canal and says it will be built ‘no matter the cost.’ AP News.<a href="https://apnews.com/article/cambodia-china-vietnam-canal-environment-mekong-c00a0b20702e21d41cf4fc35645c109a">https://apnews.com/article/cambodia-china-vietnam-canal-environment-mekong-c00a0b20702e21d41cf4fc35645c109a</a></p></li>
<li><p>World Bank. (n.d.). Vietnam economic indicators. World Bank Data Portal.<a href="https://data.worldbank.org/country/viet-nam">https://data.worldbank.org/country/viet-nam</a></p></li>
<li><p>Mekong River Commission. (n.d.). Environmental data on the Mekong Delta.<a href="https://www.mrcmekong.org/">https://www.mrcmekong.org/</a></p></li>
<li><p>Macrotrends. (n.d.). Vietnam tourism statistics 1995-2023. Macrotrends.<a href="https://www.macrotrends.net/global-metrics/countries/vnm/vietnam/tourism-statistics">https://www.macrotrends.net/global-metrics/countries/vnm/vietnam/tourism-statistics</a></p></li>
<li><p>Macrotrends. (n.d.). Vietnam GDP - Gross domestic product 1960-2023. Macrotrends.<a href="https://www.macrotrends.net/global-metrics/countries/vnm/vietnam/gdp-gross-domestic-product">https://www.macrotrends.net/global-metrics/countries/vnm/vietnam/gdp-gross-domestic-product</a></p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>